elastalert2:
  # number of replicas to run
  replicaCount: 1
  # number of helm release revisions to retain
  revisionHistoryLimit: 5
  # Default internal between alert checks against the elasticsearch datasource, in minutes
  runIntervalMins: 1
  # Location of directory where rules reside
  rulesFolder: "/opt/elastalert/rules"
  # Enable/disabe subdirectory scanning for rules
  scanSubdirectories: true
  # Default rule buffer duration, in minutes
  bufferTimeMins: 1
  # Amount of time to retry and deliver failed alerts (1440 minutes per day)
  alertRetryLimitMins: 2880
  # Default time before realerting, in minutes
  realertIntervalMins: ""

  image:
    # docker image
    repository: jertel/elastalert2
    # docker image tag
    tag: 2.14.0

  elasticsearch:
    # elasticsearch endpoint e.g. (svc.namespace||svc)
    host: es-ads-es-http.es-ads.svc.cluster.local
    # elasticsearch port
    port: 9200
    # whether or not to connect to es_host using TLS
    useSsl: "True"
    # Username if authenticating to ES with basic auth
    username: ""
    # Password if authenticating to ES with basic auth
    password: ""
    # Specifies an existing secret to be used for the ES username/password
    credentialsSecret: "es-ads-basic-authen"
    
    # The key in elasticsearch.credentialsSecret that stores the ES username
    credentialsSecretUsernameKey: "username"
    # The key in elasticsearch.credentialsSecret that stores the ES password
    credentialsSecretPasswordKey: "password"
    # whether or not to verify TLS certificates
    verifyCerts: "False"
    # Enable certificate based authentication

  rules:
    zeek_dns_mining_pools: |-
      ---
      name: zeek_dns_mining_pools
      description: Identifies clients that may be performing DNS lookups associated with common currency mining pools.
      type: any
      index: rtarf-events-soc-*
      timeframe:
        minutes: 2
      realert:
        minutes: 5
      aggregation:
        minutes: 10
      filter:
      - query:
          query_string:
            query: 'ads_rules_match:*zeek_dns_mining_pools*'
      alert:
        - "hivealerter"
        - slack
      http_post2_timeout: 10
      hive_connection:
        hive_host: http://thehive.thehive.svc.cluster.local
        hive_port: 9000
        hive_apikey: "QgFBoItDta2nKDdmhwwIH+wEzocqHWJa"
      hive_alert_config:
        customFields:
          - name: src_ip
            type: string
            value: "{}"
        follow: True
        severity: 2
        status: 'New'
        source: 'ADS'
        source_args: []
        description_args: [ name, description, ads_src_ip, ads_src_zone, ads_category, message ]
        description: |-
          **Name**: {0} 
          **Description**: {1}
          **Source IP**: {2}
          **Source Zone**: {3}
          **Category**: {4}
          **Event**: {5}
        tags: ['attack.execution', 'attack.t1569.002', 'attack.impact', 'attack.t1496']
        title: '[{0}]'
        title_args: [ name ]
        tlp: 3
        type: 'zeek_dns'
        type_args: []
      slack_webhook_url:
        - "https://hooks.slack.com/services/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"
      slack_text_string: "ALERT : [zeek_dns_mining_pools]"
      slack_title: "[zeek_dns_mining_pools]"
      slack_title_link: "http://praeco:8080/rules/zeek_dns_mining_pools"
      slack_footer: "======"
      alert_text: |-
        *Description*: Identifies clients that may be performing DNS lookups associated with common currency mining pools.
        *Source Zone*: {0}
        *Source Address*: {1}
        *Category*: {2}
      alert_text_args:
        - ads_src_zone
        - ads_src_ip
        - ads_category

    zeek_dns_torproxy: |-
      ---
      name: zeek_dns_torproxy
      description: Identifies IPs performing DNS lookups associated with common Tor proxies.
      type: any
      index: rtarf-events-soc-*
      timeframe:
        minutes: 2
      realert:
        minutes: 5
      aggregation:
        minutes: 10
      filter:
      - query:
          query_string:
            query: 'ads_rules_match:*zeek_dns_torproxy*'
      alert:
        - "hivealerter"
        - slack
      http_post2_timeout: 10
      hive_connection:
        hive_host: http://thehive.thehive.svc.cluster.local
        hive_port: 9000
        hive_apikey: "QgFBoItDta2nKDdmhwwIH+wEzocqHWJa"
      hive_alert_config:
        customFields:
          - name: src_ip
            type: string
            value: "{}"
        follow: True
        severity: 2
        status: 'New'
        source: 'ADS'
        source_args: []
        description_args: [ name, description, ads_src_ip, ads_src_zone, ads_category, message ]
        description: |-
          **Name**: {0} 
          **Description**: {1}
          **Source IP**: {2}
          **Source Zone**: {3}
          **Category**: {4}
          **Event**: {5}
        tags: ['attack.exfiltration', 'attack.t1048']
        title: '[{0}]'
        title_args: [ name ]
        tlp: 3
        type: 'zeek_dns'
        type_args: []
      slack_webhook_url:
        - "https://hooks.slack.com/services/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"
      slack_text_string: "ALERT : [zeek_dns_torproxy]"
      slack_title: "[zeek_dns_torproxy]"
      slack_title_link: "http://praeco:8080/rules/zeek_dns_torproxy"
      slack_footer: "======"
      alert_text: |-
        *Description*: Identifies IPs performing DNS lookups associated with common Tor proxies.
        *Source Zone*: {0}
        *Source Address*: {1}
        *Category*: {2}
      alert_text_args:
        - ads_src_zone
        - ads_src_ip
        - ads_category


    zeek_dns_nkn: |-
      ---
      name: zeek_dns_nkn
      description: NKN is a networking service using blockchain technology to support a decentralized network of peers. While there are legitimate uses for it, it can also be used as a C2 channel.
      type: any
      index: rtarf-events-soc-*
      timeframe:
        minutes: 2
      realert:
        minutes: 5
      aggregation:
        minutes: 10
      filter:
      - query:
          query_string:
            query: 'ads_rules_match:*zeek_dns_nkn*'
      alert:
        - "hivealerter"
        - slack
      http_post2_timeout: 10
      hive_connection:
        hive_host: http://thehive.thehive.svc.cluster.local
        hive_port: 9000
        hive_apikey: "QgFBoItDta2nKDdmhwwIH+wEzocqHWJa"
      hive_alert_config:
        customFields:
          - name: src_ip
            type: string
            value: "{}"
        follow: True
        severity: 2
        status: 'New'
        source: 'ADS'
        source_args: []
        description_args: [ name, description, ads_src_ip, ads_src_zone, ads_category, message ]
        description: |-
          **Name**: {0} 
          **Description**: {1}
          **Source IP**: {2}
          **Source Zone**: {3}
          **Category**: {4}
          **Event**: {5}
        tags: ['attack.command_and_control']
        title: '[{0}]'
        title_args: [ name ]
        tlp: 3
        type: 'zeek_dns'
        type_args: []
      slack_webhook_url:
        - "https://hooks.slack.com/services/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"
      slack_text_string: "ALERT : [zeek_dns_nkn]"
      slack_title: "[zeek_dns_nkn]"
      slack_title_link: "http://praeco:8080/rules/zeek_dns_nkn"
      slack_footer: "======"
      alert_text: |-
        *Description*: NKN is a networking service using blockchain technology to support a decentralized network of peers. While there are legitimate uses for it, it can also be used as a C2 channel.
        *Source Zone*: {0}
        *Source Address*: {1}
        *Category*: {2}
      alert_text_args:
        - ads_src_zone
        - ads_src_ip
        - ads_category

    zeek_susp_kerberos_rc4: |-
      ---
      name: zeek_susp_kerberos_rc4
      description: Detects kerberos TGS request using RC4 encryption which may be indicative of kerberoasting
      type: any
      index: rtarf-events-soc-*
      timeframe:
        minutes: 2
      realert:
        minutes: 5
      aggregation:
        minutes: 10
      filter:
      - query:
          query_string:
            query: 'ads_rules_match:*zeek_susp_kerberos_rc4*'
      alert:
        - "hivealerter"
        - slack
      http_post2_timeout: 10
      hive_connection:
        hive_host: http://thehive.thehive.svc.cluster.local
        hive_port: 9000
        hive_apikey: "QgFBoItDta2nKDdmhwwIH+wEzocqHWJa"
      hive_alert_config:
        customFields:
          - name: src_ip
            type: string
            value: "{}"
        follow: True
        severity: 2
        status: 'New'
        source: 'ADS'
        source_args: []
        description_args: [ name, description, ads_src_ip, ads_src_zone, ads_category, message ]
        description: |-
          **Name**: {0} 
          **Description**: {1}
          **Source IP**: {2}
          **Source Zone**: {3}
          **Category**: {4}
          **Event**: {5}
        tags: ['attack.credential_access', 'attack.t1558.003']
        title: '[{0}]'
        title_args: [ name ]
        tlp: 3
        type: 'zeek_kerberos'
        type_args: []
      slack_webhook_url:
        - "https://hooks.slack.com/services/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"
      slack_text_string: "ALERT : [zeek_susp_kerberos_rc4]"
      slack_title: "[zeek_susp_kerberos_rc4]"
      slack_title_link: "http://praeco:8080/rules/zeek_susp_kerberos_rc4"
      slack_footer: "======"
      alert_text: |-
        *Description*: Detects kerberos TGS request using RC4 encryption which may be indicative of kerberoasting
        *Source Zone*: {0}
        *Source Address*: {1}
        *Category*: {2}
      alert_text_args:
        - ads_src_zone
        - ads_src_ip
        - ads_category
  

    net_firewall_apt_equationgroup_c2: |-
      ---
      name: net_firewall_apt_equationgroup_c2
      description: Detects communication to C2 servers mentioned in the operational notes of the ShadowBroker leak of EquationGroup C2 tools
      type: any
      index: rtarf-events-soc-*
      timeframe:
        minutes: 2
      realert:
        minutes: 5
      aggregation:
        minutes: 10
      filter:
      - query:
          query_string:
            query: 'ads_rules_match:*net_firewall_apt_equationgroup_c2*'
      alert:
        - "hivealerter"
        - slack
      http_post2_timeout: 10
      hive_connection:
        hive_host: http://thehive.thehive.svc.cluster.local
        hive_port: 9000
        hive_apikey: "QgFBoItDta2nKDdmhwwIH+wEzocqHWJa"
      hive_alert_config:
        customFields:
          - name: src_ip
            type: string
            value: "{}"
        follow: True
        severity: 2
        status: 'New'
        source: 'ADS'
        source_args: []
        description_args: [ name, description, ads_src_ip, ads_src_zone, ads_category, message ]
        description: |-
          **Name**: {0} 
          **Description**: {1}
          **Source IP**: {2}
          **Source Zone**: {3}
          **Category**: {4}
          **Event**: {5}
        tags: ['attack.command_and_control', 'attack.g0020', 'attack.t1041']
        title: '[{0}]'
        title_args: [ name ]
        tlp: 3
        type: 'zeek_conn'
        type_args: []
      slack_webhook_url:
        - "https://hooks.slack.com/services/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"
      slack_text_string: "ALERT : [net_firewall_apt_equationgroup_c2]"
      slack_title: "[net_firewall_apt_equationgroup_c2]"
      slack_title_link: "http://praeco:8080/rules/net_firewall_apt_equationgroup_c2"
      slack_footer: "======"
      alert_text: |-
        *Description*: Detects communication to C2 servers mentioned in the operational notes of the ShadowBroker leak of EquationGroup C2 tools
        *Source Zone*: {0}
        *Source Address*: {1}
        *Category*: {2}
      alert_text_args:
        - ads_src_zone
        - ads_src_ip
        - ads_category


    zeek_rdp_public_listener: |-
      ---
      name: zeek_rdp_public_listener
      description: Detects connections from routable IPs to an RDP listener - which is indicative of a publicly-accessible RDP service.
      type: any
      index: rtarf-events-soc-*
      timeframe:
        minutes: 2
      realert:
        minutes: 5
      aggregation:
        minutes: 10
      filter:
      - query:
          query_string:
            query: 'ads_rules_match:*zeek_rdp_public_listener*'
      alert:
        - "hivealerter"
        - slack
      http_post2_timeout: 10
      hive_connection:
        hive_host: http://thehive.thehive.svc.cluster.local
        hive_port: 9000
        hive_apikey: "QgFBoItDta2nKDdmhwwIH+wEzocqHWJa"
      hive_alert_config:
        customFields:
          - name: src_ip
            type: string
            value: "{}"
        follow: True
        severity: 2
        status: 'New'
        source: 'ADS'
        source_args: []
        description_args: [ name, description, ads_src_ip, ads_src_zone, ads_category, message ]
        description: |-
          **Name**: {0} 
          **Description**: {1}
          **Source IP**: {2}
          **Source Zone**: {3}
          **Category**: {4}
          **Event**: {5}
        tags: ['attack.lateral_movement', 'attack.t1021.001']
        title: '[{0}]'
        title_args: [ name ]
        tlp: 3
        type: 'zeek_rdp'
        type_args: []
      slack_webhook_url:
        - "https://hooks.slack.com/services/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"
      slack_text_string: "ALERT : [zeek_rdp_public_listener]"
      slack_title: "[zeek_rdp_public_listener]"
      slack_title_link: "http://praeco:8080/rules/zeek_rdp_public_listener"
      slack_footer: "======"
      alert_text: |-
        *Description*: Detects connections from routable IPs to an RDP listener - which is indicative of a publicly-accessible RDP service.
        *Source Zone*: {0}
        *Source Address*: {1}
        *Category*: {2}
      alert_text_args:
        - ads_src_zone
        - ads_src_ip
        - ads_category
  

    zeek_dce_rpc_smb_spoolss_named_pipe: |-
      ---
      name: zeek_dce_rpc_smb_spoolss_named_pipe
      description: Detects the use of the spoolss named pipe over SMB. This can be used to trigger the authentication via NTLM of any machine that has the spoolservice enabled.
      type: any
      index: rtarf-events-soc-*
      timeframe:
        minutes: 2
      realert:
        minutes: 5
      aggregation:
        minutes: 10
      filter:
      - query:
          query_string:
            query: 'ads_rules_match:*zeek_dce_rpc_smb_spoolss_named_pipe*'
      alert:
        - "hivealerter"
        - slack
      http_post2_timeout: 10
      hive_connection:
        hive_host: http://thehive.thehive.svc.cluster.local
        hive_port: 9000
        hive_apikey: "QgFBoItDta2nKDdmhwwIH+wEzocqHWJa"
      hive_alert_config:
        customFields:
          - name: src_ip
            type: string
            value: "{}"
        follow: True
        severity: 2
        status: 'New'
        source: 'ADS'
        source_args: []
        description_args: [ name, description, ads_src_ip, ads_src_zone, ads_category, message ]
        description: |-
          **Name**: {0} 
          **Description**: {1}
          **Source IP**: {2}
          **Source Zone**: {3}
          **Category**: {4}
          **Event**: {5}
        tags: ['attack.lateral_movement', 'attack.t1021.002']
        title: '[{0}]'
        title_args: [ name ]
        tlp: 3
        type: 'zeek_smb_files'
        type_args: []
      slack_webhook_url:
        - "https://hooks.slack.com/services/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"
      slack_text_string: "ALERT : [zeek_dce_rpc_smb_spoolss_named_pipe]"
      slack_title: "[zeek_dce_rpc_smb_spoolss_named_pipe]"
      slack_title_link: "http://praeco:8080/rules/zeek_dce_rpc_smb_spoolss_named_pipe"
      slack_footer: "======"
      alert_text: |-
        *Description*: Detects the use of the spoolss named pipe over SMB. This can be used to trigger the authentication via NTLM of any machine that has the spoolservice enabled.
        *Source Zone*: {0}
        *Source Address*: {1}
        *Category*: {2}
      alert_text_args:
        - ads_src_zone
        - ads_src_ip
        - ads_category
  

    zeek_http_webdav_put_request: |-
      ---
      name: zeek_http_webdav_put_request
      description: A General detection for WebDav user-agent being used to PUT files on a WebDav network share. This could be an indicator of exfiltration.
      type: any
      index: rtarf-events-soc-*
      timeframe:
        minutes: 2
      realert:
        minutes: 5
      aggregation:
        minutes: 10
      filter:
      - query:
          query_string:
            query: 'ads_rules_match:*zeek_http_webdav_put_request*'
      alert:
        - "hivealerter"
        - slack
      http_post2_timeout: 10
      hive_connection:
        hive_host: http://thehive.thehive.svc.cluster.local
        hive_port: 9000
        hive_apikey: "QgFBoItDta2nKDdmhwwIH+wEzocqHWJa"
      hive_alert_config:
        customFields:
          - name: src_ip
            type: string
            value: "{}"
        follow: True
        severity: 2
        status: 'New'
        source: 'ADS'
        source_args: []
        description_args: [ name, description, ads_src_ip, ads_src_zone, ads_category, message ]
        description: |-
          **Name**: {0} 
          **Description**: {1}
          **Source IP**: {2}
          **Source Zone**: {3}
          **Category**: {4}
          **Event**: {5}
        tags: ['attack.exfiltration', 'attack.t1048.003']
        title: '[{0}]'
        title_args: [ name ]
        tlp: 3
        type: 'zeek_http'
        type_args: []
      slack_webhook_url:
        - "https://hooks.slack.com/services/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"
      slack_text_string: "ALERT : [zeek_http_webdav_put_request]"
      slack_title: "[zeek_http_webdav_put_request]"
      slack_title_link: "http://praeco:8080/rules/zeek_http_webdav_put_request"
      slack_footer: "======"
      alert_text: |-
        *Description*: A General detection for WebDav user-agent being used to PUT files on a WebDav network share. This could be an indicator of exfiltration.
        *Source Zone*: {0}
        *Source Address*: {1}
        *Category*: {2}
      alert_text_args:
        - ads_src_zone
        - ads_src_ip
        - ads_category
  

    zeek_http_omigod_no_auth_rce: |-
      ---
      name: zeek_http_omigod_no_auth_rce
      description: Detects the exploitation of OMIGOD (CVE-2021-38647) which allows remote execute (RCE) commands as root with just a single unauthenticated HTTP request.
      type: any
      index: rtarf-events-soc-*
      timeframe:
        minutes: 2
      realert:
        minutes: 5
      aggregation:
        minutes: 10
      filter:
      - query:
          query_string:
            query: 'ads_rules_match:*zeek_http_omigod_no_auth_rce*'
      alert:
        - "hivealerter"
        - slack
      http_post2_timeout: 10
      hive_connection:
        hive_host: http://thehive.thehive.svc.cluster.local
        hive_port: 9000
        hive_apikey: "QgFBoItDta2nKDdmhwwIH+wEzocqHWJa"
      hive_alert_config:
        customFields:
          - name: src_ip
            type: string
            value: "{}"
        follow: True
        severity: 2
        status: 'New'
        source: 'ADS'
        source_args: []
        description_args: [ name, description, ads_src_ip, ads_src_zone, ads_category, message ]
        description: |-
          **Name**: {0} 
          **Description**: {1}
          **Source IP**: {2}
          **Source Zone**: {3}
          **Category**: {4}
          **Event**: {5}
        tags: ['attack.privilege_escalation', 'attack.initial_access', 'attack.execution', 'attack.lateral_movement', 'attack.t1068', 'attack.t1190', 'attack.t1203', 'attack.t1021.006', 'attack.t1210']
        title: '[{0}]'
        title_args: [ name ]
        tlp: 3
        type: 'zeek_http'
        type_args: []
      slack_webhook_url:
        - "https://hooks.slack.com/services/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"
      slack_text_string: "ALERT : [zeek_http_omigod_no_auth_rce]"
      slack_title: "[zeek_http_omigod_no_auth_rce]"
      slack_title_link: "http://praeco:8080/rules/zeek_http_omigod_no_auth_rce"
      slack_footer: "======"
      alert_text: |-
        *Description*: Detects the exploitation of OMIGOD (CVE-2021-38647) which allows remote execute (RCE) commands as root with just a single unauthenticated HTTP request.
        *Source Zone*: {0}
        *Source Address*: {1}
        *Category*: {2}
      alert_text_args:
        - ads_src_zone
        - ads_src_ip
        - ads_category
  

    zeek_http_executable_download_from_webdav: |-
      ---
      name: zeek_http_executable_download_from_webdav
      description: Detects executable access via webdav6. Can be seen in APT 29 such as from the emulated APT 29 hackathon https://github.com/OTRF/detection-hackathon-apt29/
      type: any
      index: rtarf-events-soc-*
      timeframe:
        minutes: 2
      realert:
        minutes: 5
      aggregation:
        minutes: 10
      filter:
      - query:
          query_string:
            query: 'ads_rules_match:*zeek_http_executable_download_from_webdav*'
      alert:
        - "hivealerter"
        - slack
      http_post2_timeout: 10
      hive_connection:
        hive_host: http://thehive.thehive.svc.cluster.local
        hive_port: 9000
        hive_apikey: "QgFBoItDta2nKDdmhwwIH+wEzocqHWJa"
      hive_alert_config:
        customFields:
          - name: src_ip
            type: string
            value: "{}"
        follow: True
        severity: 2
        status: 'New'
        source: 'ADS'
        source_args: []
        description_args: [ name, description, ads_src_ip, ads_src_zone, ads_category, message ]
        description: |-
          **Name**: {0} 
          **Description**: {1}
          **Source IP**: {2}
          **Source Zone**: {3}
          **Category**: {4}
          **Event**: {5}
        tags: ['attack.command_and_control', 'attack.t1105']
        title: '[{0}]'
        title_args: [ name ]
        tlp: 3
        type: 'zeek_http'
        type_args: []
      slack_webhook_url:
        - "https://hooks.slack.com/services/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"
      slack_text_string: "ALERT : [zeek_http_executable_download_from_webdav]"
      slack_title: "[zeek_http_executable_download_from_webdav]"
      slack_title_link: "http://praeco:8080/rules/zeek_http_executable_download_from_webdav"
      slack_footer: "======"
      alert_text: |-
        *Description*: Detects executable access via webdav6. Can be seen in APT 29 such as from the emulated APT 29 hackathon https://github.com/OTRF/detection-hackathon-apt29/
        *Source Zone*: {0}
        *Source Address*: {1}
        *Category*: {2}
      alert_text_args:
        - ads_src_zone
        - ads_src_ip
        - ads_category


    zeek_smb_converted_win_transferring_files_with_credential_data: |-
      ---
      name: zeek_smb_converted_win_transferring_files_with_credential_data
      description: Transferring files with well-known filenames (sensitive files with credential data) using network shares
      type: any
      index: rtarf-events-soc-*
      timeframe:
        minutes: 2
      realert:
        minutes: 5
      aggregation:
        minutes: 10
      filter:
      - query:
          query_string:
            query: 'ads_rules_match:*zeek_smb_converted_win_transferring_files_with_credential_data*'
      alert:
        - "hivealerter"
        - slack
      http_post2_timeout: 10
      hive_connection:
        hive_host: http://thehive.thehive.svc.cluster.local
        hive_port: 9000
        hive_apikey: "QgFBoItDta2nKDdmhwwIH+wEzocqHWJa"
      hive_alert_config:
        customFields:
          - name: src_ip
            type: string
            value: "{}"
        follow: True
        severity: 2
        status: 'New'
        source: 'ADS'
        source_args: []
        description_args: [ name, description, ads_src_ip, ads_src_zone, ads_category, message ]
        description: |-
          **Name**: {0} 
          **Description**: {1}
          **Source IP**: {2}
          **Source Zone**: {3}
          **Category**: {4}
          **Event**: {5}
        tags: ['attack.credential_access', 'attack.t1003.002', 'attack.t1003.001', 'attack.t1003.003']
        title: '[{0}]'
        title_args: [ name ]
        tlp: 3
        type: 'zeek_smb_files'
        type_args: []
      slack_webhook_url:
        - "https://hooks.slack.com/services/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"
      slack_text_string: "ALERT : [zeek_smb_converted_win_transferring_files_with_credential_data]"
      slack_title: "[zeek_smb_converted_win_transferring_files_with_credential_data]"
      slack_title_link: "http://praeco:8080/rules/zeek_smb_converted_win_transferring_files_with_credential_data"
      slack_footer: "======"
      alert_text: |-
        *Description*: Transferring files with well-known filenames (sensitive files with credential data) using network shares
        *Source Zone*: {0}
        *Source Address*: {1}
        *Category*: {2}
      alert_text_args:
        - ads_src_zone
        - ads_src_ip
        - ads_category


    zeek_smb_converted_win_susp_raccess_sensitive_fext: |-
      ---
      name: zeek_smb_converted_win_susp_raccess_sensitive_fext
      description: Detects known sensitive file extensions via Zeek
      type: any
      index: rtarf-events-soc-*
      timeframe:
        minutes: 2
      realert:
        minutes: 5
      aggregation:
        minutes: 10
      filter:
      - query:
          query_string:
            query: 'ads_rules_match:*zeek_smb_converted_win_susp_raccess_sensitive_fext*'
      alert:
        - "hivealerter"
        - slack
      http_post2_timeout: 10
      hive_connection:
        hive_host: http://thehive.thehive.svc.cluster.local
        hive_port: 9000
        hive_apikey: "QgFBoItDta2nKDdmhwwIH+wEzocqHWJa"
      hive_alert_config:
        customFields:
          - name: src_ip
            type: string
            value: "{}"
        follow: True
        severity: 2
        status: 'New'
        source: 'ADS'
        source_args: []
        description_args: [ name, description, ads_src_ip, ads_src_zone, ads_category, message ]
        description: |-
          **Name**: {0} 
          **Description**: {1}
          **Source IP**: {2}
          **Source Zone**: {3}
          **Category**: {4}
          **Event**: {5}
        tags: ['attack.collection']
        title: '[{0}]'
        title_args: [ name ]
        tlp: 3
        type: 'zeek_smb_files'
        type_args: []
      slack_webhook_url:
        - "https://hooks.slack.com/services/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"
      slack_text_string: "ALERT : [zeek_smb_converted_win_susp_raccess_sensitive_fext]"
      slack_title: "[zeek_smb_converted_win_susp_raccess_sensitive_fext]"
      slack_title_link: "http://praeco:8080/rules/zeek_smb_converted_win_susp_raccess_sensitive_fext"
      slack_footer: "======"
      alert_text: |-
        *Description*: Detects known sensitive file extensions via Zeek
        *Source Zone*: {0}
        *Source Address*: {1}
        *Category*: {2}
      alert_text_args:
        - ads_src_zone
        - ads_src_ip
        - ads_category


    zeek_smb_converted_win_susp_psexec: |-
      ---
      name: zeek_smb_converted_win_susp_psexec
      description: Detects execution of psexec or paexec with renamed service name, this rule helps to filter out the noise if psexec is used for legit purposes or if attacker uses a different psexec client other than sysinternal one
      type: any
      index: rtarf-events-soc-*
      timeframe:
        minutes: 2
      realert:
        minutes: 5
      aggregation:
        minutes: 10
      filter:
      - query:
          query_string:
            query: 'ads_rules_match:*zeek_smb_converted_win_susp_psexec*'
      alert:
        - "hivealerter"
        - slack
      http_post2_timeout: 10
      hive_connection:
        hive_host: http://thehive.thehive.svc.cluster.local
        hive_port: 9000
        hive_apikey: "QgFBoItDta2nKDdmhwwIH+wEzocqHWJa"
      hive_alert_config:
        customFields:
          - name: src_ip
            type: string
            value: "{}"
        follow: True
        severity: 2
        status: 'New'
        source: 'ADS'
        source_args: []
        description_args: [ name, description, ads_src_ip, ads_src_zone, ads_category, message ]
        description: |-
          **Name**: {0} 
          **Description**: {1}
          **Source IP**: {2}
          **Source Zone**: {3}
          **Category**: {4}
          **Event**: {5}
        tags: ['attack.lateral_movement', 'attack.t1021.002']
        title: '[{0}]'
        title_args: [ name ]
        tlp: 3
        type: 'zeek_smb_files'
        type_args: []
      slack_webhook_url:
        - "https://hooks.slack.com/services/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"
      slack_text_string: "ALERT : [zeek_smb_converted_win_susp_psexec]"
      slack_title: "[zeek_smb_converted_win_susp_psexec]"
      slack_title_link: "http://praeco:8080/rules/zeek_smb_converted_win_susp_psexec"
      slack_footer: "======"
      alert_text: |-
        *Description*: Detects execution of psexec or paexec with renamed service name
        *Source Zone*: {0}
        *Source Address*: {1}
        *Category*: {2}
      alert_text_args:
        - ads_src_zone
        - ads_src_ip
        - ads_category


    zeek_smb_converted_win_impacket_secretdump: |-
      ---
      name: zeek_smb_converted_win_impacket_secretdump
      description: Detect AD credential dumping using impacket secretdump HKTL. Based on the SIGMA rules/windows/builtin/win_impacket_secretdump.yml
      type: any
      index: rtarf-events-soc-*
      timeframe:
        minutes: 2
      realert:
        minutes: 5
      aggregation:
        minutes: 10
      filter:
      - query:
          query_string:
            query: 'ads_rules_match:*zeek_smb_converted_win_impacket_secretdump*'
      alert:
        - "hivealerter"
        - slack
      http_post2_timeout: 10
      hive_connection:
        hive_host: http://thehive.thehive.svc.cluster.local
        hive_port: 9000
        hive_apikey: "QgFBoItDta2nKDdmhwwIH+wEzocqHWJa"
      hive_alert_config:
        customFields:
          - name: src_ip
            type: string
            value: "{}"
        follow: True
        severity: 2
        status: 'New'
        source: 'ADS'
        source_args: []
        description_args: [ name, description, ads_src_ip, ads_src_zone, ads_category, message ]
        description: |-
          **Name**: {0} 
          **Description**: {1}
          **Source IP**: {2}
          **Source Zone**: {3}
          **Category**: {4}
          **Event**: {5}
        tags: ['attack.credential_access', 'attack.t1003.002', 'attack.t1003.004', 'attack.t1003.003']
        title: '[{0}]'
        title_args: [ name ]
        tlp: 3
        type: 'zeek_smb_files'
        type_args: []
      slack_webhook_url:
        - "https://hooks.slack.com/services/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"
      slack_text_string: "ALERT : [zeek_smb_converted_win_impacket_secretdump]"
      slack_title: "[zeek_smb_converted_win_impacket_secretdump]"
      slack_title_link: "http://praeco:8080/rules/zeek_smb_converted_win_impacket_secretdump"
      slack_footer: "======"
      alert_text: |-
        *Description*: Detect AD credential dumping using impacket secretdump HKTL. Based on the SIGMA rules/windows/builtin/win_impacket_secretdump.yml
        *Source Zone*: {0}
        *Source Address*: {1}
        *Category*: {2}
      alert_text_args:
        - ads_src_zone
        - ads_src_ip
        - ads_category


    zeek_smb_converted_win_atsvc_task: |-
      ---
      name: zeek_smb_converted_win_atsvc_task
      description: Detects remote task creation via at.exe or API interacting with ATSVC namedpipe
      type: any
      index: rtarf-events-soc-*
      timeframe:
        minutes: 2
      realert:
        minutes: 5
      aggregation:
        minutes: 10
      filter:
      - query:
          query_string:
            query: 'ads_rules_match:*zeek_smb_converted_win_atsvc_task*'
      alert:
        - "hivealerter"
        - slack
      http_post2_timeout: 10
      hive_connection:
        hive_host: http://thehive.thehive.svc.cluster.local
        hive_port: 9000
        hive_apikey: "QgFBoItDta2nKDdmhwwIH+wEzocqHWJa"
      hive_alert_config:
        customFields:
          - name: src_ip
            type: string
            value: "{}"
        follow: True
        severity: 2
        status: 'New'
        source: 'ADS'
        source_args: []
        description_args: [ name, description, ads_src_ip, ads_src_zone, ads_category, message ]
        description: |-
          **Name**: {0} 
          **Description**: {1}
          **Source IP**: {2}
          **Source Zone**: {3}
          **Category**: {4}
          **Event**: {5}
        tags: ['attack.lateral_movement', 'attack.persistence', 'car.2013-05-004', 'car.2015-04-001', 'attack.t1053.002']
        title: '[{0}]'
        title_args: [ name ]
        tlp: 3
        type: 'zeek_smb_files'
        type_args: []
      slack_webhook_url:
        - "https://hooks.slack.com/services/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"
      slack_text_string: "ALERT : [zeek_smb_converted_win_atsvc_task]"
      slack_title: "[zeek_smb_converted_win_atsvc_task]"
      slack_title_link: "http://praeco:8080/rules/zeek_smb_converted_win_atsvc_task"
      slack_footer: "======"
      alert_text: |-
        *Description*: Detects remote task creation via at.exe or API interacting with ATSVC namedpipe
        *Source Zone*: {0}
        *Source Address*: {1}
        *Category*: {2}
      alert_text_args:
        - ads_src_zone
        - ads_src_ip
        - ads_category


    blacklist_by_src_ip: |-
      ---
      name: blacklist_by_src_ip
      description: Detects source IP address found in the blacklist.
      type: any
      index: rtarf-events-soc-*
      timeframe:
        minutes: 2
      realert:
        minutes: 5
      aggregation:
        minutes: 10
      filter:
      - query:
          query_string:
            query: 'ads_rules_match:*blacklist_by_src_ip*'
      alert:
        - "hivealerter"
        - slack
      http_post2_timeout: 10
      hive_connection:
        hive_host: http://thehive.thehive.svc.cluster.local
        hive_port: 9000
        hive_apikey: "QgFBoItDta2nKDdmhwwIH+wEzocqHWJa"
      hive_alert_config:
        customFields:
          - name: src_ip
            type: string
            value: "{}"
        follow: True
        severity: 2
        status: 'New'
        source: 'ADS'
        source_args: []
        description_args: [ name, description, ads_src_ip, ads_src_zone, ads_category, message ]
        description: |-
          **Name**: {0} 
          **Description**: {1}
          **Source IP**: {2}
          **Source Zone**: {3}
          **Category**: {4}
          **Event**: {5}
        tags: []
        title: '[{0}]'
        title_args: [ name ]
        tlp: 3
        type: 'zeek_conn'
        type_args: []
      slack_webhook_url:
        - "https://hooks.slack.com/services/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"
      slack_text_string: "ALERT : [blacklist_by_src_ip]"
      slack_title: "[blacklist_by_src_ip]"
      slack_title_link: "http://praeco:8080/rules/blacklist_by_src_ip"
      slack_footer: "======"
      alert_text: |-
        *Description*: Detects source IP address found in the blacklist.
        *Source Zone*: {0}
        *Source Address*: {1}
        *Category*: {2}
      alert_text_args:
        - ads_src_zone
        - ads_src_ip
        - ads_category


    blacklist_by_dst_ip: |-
      ---
      name: blacklist_by_dst_ip
      description: Detects destination IP address found in the blacklist.
      type: any
      index: rtarf-events-soc-*
      timeframe:
        minutes: 2
      realert:
        minutes: 5
      aggregation:
        minutes: 10
      filter:
      - query:
          query_string:
            query: 'ads_rules_match:*blacklist_by_dst_ip*'
      alert:
        - "hivealerter"
        - slack
      http_post2_timeout: 10
      hive_connection:
        hive_host: http://thehive.thehive.svc.cluster.local
        hive_port: 9000
        hive_apikey: "QgFBoItDta2nKDdmhwwIH+wEzocqHWJa"
      hive_alert_config:
        customFields:
          - name: src_ip
            type: string
            value: "{}"
        follow: True
        severity: 2
        status: 'New'
        source: 'ADS'
        source_args: []
        description_args: [ name, description, ads_src_ip, ads_src_zone, ads_category, message ]
        description: |-
          **Name**: {0} 
          **Description**: {1}
          **Source IP**: {2}
          **Source Zone**: {3}
          **Category**: {4}
          **Event**: {5}
        tags: []
        title: '[{0}]'
        title_args: [ name ]
        tlp: 3
        type: 'zeek_conn'
        type_args: []
      slack_webhook_url:
        - "https://hooks.slack.com/services/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"
      slack_text_string: "ALERT : [blacklist_by_dst_ip]"
      slack_title: "[blacklist_by_dst_ip]"
      slack_title_link: "http://praeco:8080/rules/blacklist_by_dst_ip"
      slack_footer: "======"
      alert_text: |-
        *Description*: Detects destination IP address found in the blacklist.
        *Source Zone*: {0}
        *Source Address*: {1}
        *Category*: {2}
      alert_text_args:
        - ads_src_zone
        - ads_src_ip
        - ads_category


    blacklist_by_hash: |-
      ---
      name: blacklist_by_hash
      description: Detects file hash in the blacklist.
      type: any
      index: rtarf-events-soc-*
      timeframe:
        minutes: 2
      realert:
        minutes: 5
      aggregation:
        minutes: 10
      filter:
      - query:
          query_string:
            query: 'ads_rules_match:*blacklist_by_hash*'
      alert:
        - "hivealerter"
        - slack
      http_post2_timeout: 10
      hive_connection:
        hive_host: http://thehive.thehive.svc.cluster.local
        hive_port: 9000
        hive_apikey: "QgFBoItDta2nKDdmhwwIH+wEzocqHWJa"
      hive_alert_config:
        customFields:
          - name: src_ip
            type: string
            value: "{}"
        follow: True
        severity: 2
        status: 'New'
        source: 'ADS'
        source_args: []
        description_args: [ name, description, ads_src_ip, ads_src_zone, ads_category, message ]
        description: |-
          **Name**: {0} 
          **Description**: {1}
          **Source IP**: {2}
          **Source Zone**: {3}
          **Category**: {4}
          **Event**: {5}
        tags: []
        title: '[{0}]'
        title_args: [ name ]
        tlp: 3
        type: 'zeek_conn'
        type_args: []
      slack_webhook_url:
        - "https://hooks.slack.com/services/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"
      slack_text_string: "ALERT : [blacklist_by_hash]"
      slack_title: "[blacklist_by_hash]"
      slack_title_link: "http://praeco:8080/rules/blacklist_by_hash"
      slack_footer: "======"
      alert_text: |-
        *Description*: Detects file hash in the blacklist.
        *Source Zone*: {0}
        *Source Address*: {1}
        *Category*: {2}
        *SHA1*: {3}
        *SHA256*: {4}
      alert_text_args:
        - ads_src_zone
        - ads_src_ip
        - ads_category
        - ads_sha1
        - ads_sha256


    blacklist_by_url: |-
      ---
      name: blacklist_by_url
      description: Detects url in the blacklist.
      type: any
      index: rtarf-events-soc-*
      timeframe:
        minutes: 2
      realert:
        minutes: 5
      aggregation:
        minutes: 10
      filter:
      - query:
          query_string:
            query: 'ads_rules_match:*blacklist_by_url*'
      alert:
        - "hivealerter"
        - slack
      http_post2_timeout: 10
      hive_connection:
        hive_host: http://thehive.thehive.svc.cluster.local
        hive_port: 9000
        hive_apikey: "QgFBoItDta2nKDdmhwwIH+wEzocqHWJa"
      hive_alert_config:
        customFields:
          - name: src_ip
            type: string
            value: "{}"
        follow: True
        severity: 2
        status: 'New'
        source: 'ADS'
        source_args: []
        description_args: [ name, description, ads_src_ip, ads_src_zone, ads_category, message ]
        description: |-
          **Name**: {0} 
          **Description**: {1}
          **Source IP**: {2}
          **Source Zone**: {3}
          **Category**: {4}
          **Event**: {5}
        tags: []
        title: '[{0}]'
        title_args: [ name ]
        tlp: 3
        type: 'zeek_conn'
        type_args: []
      slack_webhook_url:
        - "https://hooks.slack.com/services/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"
      slack_text_string: "ALERT : [blacklist_by_url]"
      slack_title: "[blacklist_by_url]"
      slack_title_link: "http://praeco:8080/rules/blacklist_by_url"
      slack_footer: "======"
      alert_text: |-
        *Description*: Detects url in the blacklist.
        *Source Zone*: {0}
        *Source Address*: {1}
        *Category*: {2}
        *URL*: {3}
      alert_text_args:
        - ads_src_zone
        - ads_src_ip
        - ads_category
        - ads_url_path


    blacklist_by_domain: |-
      ---
      name: blacklist_by_domain
      description: Detects domain in the blacklist.
      type: any
      index: rtarf-events-soc-*
      timeframe:
        minutes: 2
      realert:
        minutes: 5
      aggregation:
        minutes: 10
      filter:
      - query:
          query_string:
            query: 'ads_rules_match:*blacklist_by_domain*'
      alert:
        - "hivealerter"
        - slack
      http_post2_timeout: 10
      hive_connection:
        hive_host: http://thehive.thehive.svc.cluster.local
        hive_port: 9000
        hive_apikey: "QgFBoItDta2nKDdmhwwIH+wEzocqHWJa"
      hive_alert_config:
        customFields:
          - name: src_ip
            type: string
            value: "{}"
        follow: True
        severity: 2
        status: 'New'
        source: 'ADS'
        source_args: []
        description_args: [ name, description, ads_src_ip, ads_src_zone, ads_category, message ]
        description: |-
          **Name**: {0} 
          **Description**: {1}
          **Source IP**: {2}
          **Source Zone**: {3}
          **Category**: {4}
          **Event**: {5}
        tags: []
        title: '[{0}]'
        title_args: [ name ]
        tlp: 3
        type: 'zeek_conn'
        type_args: []
      slack_webhook_url:
        - "https://hooks.slack.com/services/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"
      slack_text_string: "ALERT : [blacklist_by_domain]"
      slack_title: "[blacklist_by_domain]"
      slack_title_link: "http://praeco:8080/rules/blacklist_by_domain"
      slack_footer: "======"
      alert_text: |-
        *Description*: Detects domain in the blacklist.
        *Source Zone*: {0}
        *Source Address*: {1}
        *Category*: {2}
        *Domain*: {3}
      alert_text_args:
        - ads_src_zone
        - ads_src_ip
        - ads_category
        - ads_host

    misp_ioc_by_dst_ip: |-
      ---
      name: misp_ioc_by_dst_ip
      description: Detects destination IP address found in MISP.
      type: any
      index: rtarf-events-soc-*
      timeframe:
        minutes: 2
      realert:
        minutes: 5
      aggregation:
        minutes: 60
      filter:
      - query:
          query_string:
            query: 'ads_rules_match:*misp_ioc_by_dst_ip*'
      alert:
        - "hivealerter"
        - slack
      http_post2_timeout: 10
      hive_connection:
        hive_host: http://thehive.thehive.svc.cluster.local
        hive_port: 9000
        hive_apikey: "QgFBoItDta2nKDdmhwwIH+wEzocqHWJa"
      hive_alert_config:
        customFields:
          - name: src_ip
            type: string
            value: "{}"
        follow: True
        severity: 2
        status: 'New'
        source: 'ADS'
        source_args: []
        description_args: [ name, description, ads_src_ip, ads_src_zone, ads_category, message ]
        description: |-
          **Name**: {0} 
          **Description**: {1}
          **Source IP**: {2}
          **Source Zone**: {3}
          **Category**: {4}
          **Event**: {5}
        tags: []
        title: '[{0}]'
        title_args: [ name ]
        tlp: 3
        type: 'zeek_conn'
        type_args: []
      slack_webhook_url:
        - "https://hooks.slack.com/services/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"
      slack_text_string: "ALERT : [misp_ioc_by_dst_ip]"
      slack_title: "[misp_ioc_by_dst_ip]"
      slack_title_link: "http://praeco:8080/rules/misp_ioc_by_dst_ip"
      slack_footer: "======"
      alert_text: |-
        *Description*: Detects destination IP address found in MISP.
        *Source Zone*: {0}
        *Source Address*: {1}
        *Category*: {2}
      alert_text_args:
        - ads_src_zone
        - ads_src_ip
        - ads_category


    misp_ioc_by_src_ip: |-
      ---
      name: misp_ioc_by_src_ip
      description: Detects source IP address found in MISP.
      type: any
      index: rtarf-events-soc-*
      timeframe:
        minutes: 2
      realert:
        minutes: 5
      aggregation:
        minutes: 10
      filter:
      - query:
          query_string:
            query: 'ads_rules_match:*misp_ioc_by_src_ip*'
      alert:
        - "hivealerter"
        - slack
      http_post2_timeout: 10
      hive_connection:
        hive_host: http://thehive.thehive.svc.cluster.local
        hive_port: 9000
        hive_apikey: "QgFBoItDta2nKDdmhwwIH+wEzocqHWJa"
      hive_alert_config:
        customFields:
          - name: src_ip
            type: string
            value: "{}"
        follow: True
        severity: 2
        status: 'New'
        source: 'ADS'
        source_args: []
        description_args: [ name, description, ads_src_ip, ads_src_zone, ads_category, message ]
        description: |-
          **Name**: {0} 
          **Description**: {1}
          **Source IP**: {2}
          **Source Zone**: {3}
          **Category**: {4}
          **Event**: {5}
        tags: []
        title: '[{0}]'
        title_args: [ name ]
        tlp: 3
        type: 'zeek_conn'
        type_args: []
      slack_webhook_url:
        - "https://hooks.slack.com/services/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"
      slack_text_string: "ALERT : [misp_ioc_by_src_ip]"
      slack_title: "[misp_ioc_by_src_ip]"
      slack_title_link: "http://praeco:8080/rules/misp_ioc_by_src_ip"
      slack_footer: "======"
      alert_text: |-
        *Description*: Detects source IP address found in MISP.
        *Source Zone*: {0}
        *Source Address*: {1}
        *Category*: {2}
      alert_text_args:
        - ads_src_zone
        - ads_src_ip
        - ads_category


    misp_ioc_by_sha256: |-
      ---
      name: misp_ioc_by_sha256
      description: File SHA256 found in MISP.
      type: any
      index: rtarf-events-soc-*
      timeframe:
        minutes: 2
      realert:
        minutes: 5
      aggregation:
        minutes: 10
      filter:
      - query:
          query_string:
            query: 'ads_rules_match:*misp_ioc_by_sha256*'
      alert:
        - "hivealerter"
        - slack
      http_post2_timeout: 10
      hive_connection:
        hive_host: http://thehive.thehive.svc.cluster.local
        hive_port: 9000
        hive_apikey: "QgFBoItDta2nKDdmhwwIH+wEzocqHWJa"
      hive_alert_config:
        customFields:
          - name: src_ip
            type: string
            value: "{}"
        follow: True
        severity: 2
        status: 'New'
        source: 'ADS'
        source_args: []
        description_args: [ name, description, ads_src_ip, ads_src_zone, ads_category, message ]
        description: |-
          **Name**: {0} 
          **Description**: {1}
          **Source IP**: {2}
          **Source Zone**: {3}
          **Category**: {4}
          **Event**: {5}
        tags: []
        title: '[{0}]'
        title_args: [ name ]
        tlp: 3
        type: 'zeek'
        type_args: []
      slack_webhook_url:
        - "https://hooks.slack.com/services/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"
      slack_text_string: "ALERT : [misp_ioc_by_sha256]"
      slack_title: "[misp_ioc_by_sha256]"
      slack_title_link: "http://praeco:8080/rules/misp_ioc_by_sha256"
      slack_footer: "======"
      alert_text: |-
        *Description*: File SHA256 found in MISP.
        *Source Zone*: {0}
        *Source Address*: {1}
        *Category*: {2}
      alert_text_args:
        - ads_src_zone
        - ads_src_ip
        - ads_category


    snort_priority_high_found: |-
      ---
      name: snort_priority_high_found
      description: Detects Snort with priority high.
      type: any
      index: rtarf-events-soc-*
      timeframe:
        minutes: 2
      realert:
        minutes: 5
      aggregation:
        minutes: 10
      filter:
      - query:
          query_string:
            query: 'ads_rules_match:*snort_priority_high_found*'
      alert:
        - hivealerter
        - slack
      http_post2_timeout: 10
      hive_connection:
        hive_host: http://thehive.thehive.svc.cluster.local
        hive_port: 9000
        hive_apikey: "QgFBoItDta2nKDdmhwwIH+wEzocqHWJa"
      hive_alert_config:
        follow: True
        severity: 2
        status: 'New'
        source: 'ADS'
        source_args: []
        description_args: [ name, description, ads_src_ip, ads_src_zone, ads_category, ads_rulename, message ]
        description: |-
          **Name**: {0} 
          **Description**: {1}
          **Source IP**: {2}
          **Source Zone**: {3}
          **Category**: {4}
          **Rule Name**: {5}
          **Event**: {6}
        tags: []
        title: '[{0}]'
        title_args: [ name ]
        tlp: 3
        type: 'snort'
        type_args: []
      slack_webhook_url:
        - "https://hooks.slack.com/services/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"
      slack_text_string: "ALERT : [snort_priority_high_found]"
      slack_title: "[snort_priority_high_found]"
      slack_title_link: "http://praeco:8080/rules/snort_priority_high_found"
      slack_footer: "======"
      alert_text: |-
        *Description*: Detects Snort with priority high.
        *Source Zone*: {0}
        *Source Address*: {1}
        *Snort Rule*: {2}
        *Category*: {3}
      alert_text_args:
        - ads_src_zone
        - ads_src_ip
        - ads_rulename
        - ads_category


    snort_malware_found: |-
      ---
      name: snort_malware_found
      description: Malware detected by Snort.
      type: any
      index: rtarf-events-soc-*
      timeframe:
        minutes: 2
      realert:
        minutes: 5
      aggregation:
        minutes: 10
      filter:
      - query:
          query_string:
            query: 'ads_rules_match:*snort_malware_found*'
      alert:
        - hivealerter
        - slack
      http_post2_timeout: 10
      hive_connection:
        hive_host: http://thehive.thehive.svc.cluster.local
        hive_port: 9000
        hive_apikey: "QgFBoItDta2nKDdmhwwIH+wEzocqHWJa"
      hive_alert_config:
        follow: True
        severity: 2
        status: 'New'
        source: 'ADS'
        source_args: []
        description_args: [ name, description, ads_src_ip, ads_src_zone, ads_category, ads_rulename, message ]
        description: |-
          **Name**: {0} 
          **Description**: {1}
          **Source IP**: {2}
          **Source Zone**: {3}
          **Category**: {4}
          **Rule Name**: {5}
          **Event**: {6}
        tags: []
        title: '[{0}]'
        title_args: [ name ]
        tlp: 3
        type: 'snort'
        type_args: []
      slack_webhook_url:
        - "https://hooks.slack.com/services/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"
      slack_text_string: "ALERT : [snort_malware_found]"
      slack_title: "[snort_malware_found]"
      slack_title_link: "http://praeco:8080/rules/snort_malware_found"
      slack_footer: "======"
      alert_text: |-
        *Description*: Detects Snort with priority high.
        *Source Zone*: {0}
        *Source Address*: {1}
        *Snort Rule*: {2}
        *Category*: {3}
      alert_text_args:
        - ads_src_zone
        - ads_src_ip
        - ads_rulename
        - ads_category

    snort_exploit_found: |-
      ---
      name: snort_exploit_found
      description: Malware detected by Snort.
      type: any
      index: rtarf-events-soc-*
      timeframe:
        minutes: 2
      realert:
        minutes: 5
      aggregation:
        minutes: 10
      filter:
      - query:
          query_string:
            query: 'ads_rules_match:*snort_exploit_found*'
      alert:
        - hivealerter
        - slack
      http_post2_timeout: 10
      hive_connection:
        hive_host: http://thehive.thehive.svc.cluster.local
        hive_port: 9000
        hive_apikey: "QgFBoItDta2nKDdmhwwIH+wEzocqHWJa"
      hive_alert_config:
        follow: True
        severity: 2
        status: 'New'
        source: 'ADS'
        source_args: []
        description_args: [ name, description, ads_src_ip, ads_src_zone, ads_category, ads_rulename, message ]
        description: |-
          **Name**: {0} 
          **Description**: {1}
          **Source IP**: {2}
          **Source Zone**: {3}
          **Category**: {4}
          **Rule Name**: {5}
          **Event**: {6}
        tags: []
        title: '[{0}]'
        title_args: [ name ]
        tlp: 3
        type: 'snort'
        type_args: []
      slack_webhook_url:
        - "https://hooks.slack.com/services/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"
      slack_text_string: "ALERT : [snort_exploit_found]"
      slack_title: "[snort_exploit_found]"
      slack_title_link: "http://praeco:8080/rules/snort_exploit_found"
      slack_footer: "======"
      alert_text: |-
        *Description*: Detects Snort with priority high.
        *Source Zone*: {0}
        *Source Address*: {1}
        *Snort Rule*: {2}
        *Category*: {3}
      alert_text_args:
        - ads_src_zone
        - ads_src_ip
        - ads_rulename
        - ads_category

    cobalt_strike_command_and_control_beacon: |-
      ---
      name: cobalt_strike_command_and_control_beacon
      description: Detects CloudStrike command and control beacon.
      type: any
      index: rtarf-events-soc-*
      timeframe:
        minutes: 2
      realert:
        minutes: 5
      aggregation:
        minutes: 10
      filter:
      - query:
          query_string:
            query: 'ads_rules_match:*cobalt_strike_command_and_control_beacon*'
      alert:
        - "hivealerter"
        - slack
      http_post2_timeout: 10
      hive_connection:
        hive_host: http://thehive.thehive.svc.cluster.local
        hive_port: 9000
        hive_apikey: "QgFBoItDta2nKDdmhwwIH+wEzocqHWJa"
      hive_alert_config:
        follow: True
        severity: 2
        status: 'New'
        source: 'ADS'
        source_args: []
        description_args: [ name, description, ads_src_ip, ads_src_zone, ads_category, ads_host, message ]
        description: |-
          **Name**: {0} 
          **Description**: {1}
          **Source IP**: {2}
          **Source Zone**: {3}
          **Category**: {4}
          **Host Name**: {5}
          **Event**: {6}
        tags: ['attack.command_and_control', 'attack.t1071', 'attack.t1568', 'attack.t1568.002']
        title: '[{0}]'
        title_args: [ name ]
        tlp: 3
        type: '{0}'
        type_args: [ ads_category ]
      slack_webhook_url:
        - "https://hooks.slack.com/services/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"
      slack_text_string: "ALERT : [cobalt_strike_command_and_control_beacon]"
      slack_title: "[cobalt_strike_command_and_control_beacon]"
      slack_title_link: "http://praeco:8080/rules/cobalt_strike_command_and_control_beacon"
      slack_footer: "======"
      alert_text: |-
        *Description*: Detects CloudStrike command and control beacon
        *Source Zone*: {0}
        *Source Address*: {1}
        *Category*: {2}
      alert_text_args:
        - ads_src_zone
        - ads_src_ip
        - ads_category
